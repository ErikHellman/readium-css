/* Readium CSS 
   User Overrides for RTL

   A customizable stylesheet to manage user settings

   Repo: https://github.com/readium/readium-css */

/* Variables are added to html (setProperty -> style) */

/* Readium CSS 
   Columns number pref

   A submodule managing columns number for user settings
   Part of “Chrome Advanced” class – no flag required.

   Repo: https://github.com/readium/readium-css */

/* Number of columns = 1 | 2 */

/* We still need to see if we allow users to force number of columns for all configs, currently it behaves as an "auto" setting */

/* apply col setting except for tablet portrait */

@media screen and (min-width: 60em), screen and (min-device-width: 36em) and (max-device-width: 47em) and (orientation: landscape) {
  :root[style*="--USER__colCount: 1"],
  :root[style*="--USER__colCount:1"],
  :root[style*="--USER__colCount: 2"],
  :root[style*="--USER__colCount:2"] {
    -webkit-column-count: var(--USER__colCount);
    -moz-column-count: var(--USER__colCount);
    column-count: var(--USER__colCount);
  }

/* If one column, make sure we limit line-length */
:root[style*="--USER__colCount: 1"],
:root[style*="--USER__colCount:1"] {
  --RS__maxLineLength: 40rem !important; /* This is the only way for the user setting to work in webkit… */
  --RS__colWidth: 100vw;
}

/* If smartphone landscape, and 2 columns, col width the same as iPad landscape + desktop */
  :root[style*="--USER__colCount: 2"],
  :root[style*="--USER__colCount:2"] {
    --RS__colWidth: auto; /* User explicitely tells he/she wants 2 columns, we reset floor value */
  }
}

/* Readium CSS 
   Page margins pref

   A submodule managing page margins for user settings
   Part of “Chrome Advanced” class – no flag required.

   Repo: https://github.com/readium/readium-css */

/* Page Margins: the user margin is a factor of the page gutter e.g. 0.5, 0.75, 1, 1.25, 1.5, etc. */

:root[style*="--USER__pageMargins"] body {
  padding: 0 calc(var(--RS__pageGutter) * var(--USER__pageMargins)) !important;
}

/* Readium CSS 
   Custom colors pref

   A submodule managing custom colors for user settings
   Part of “Chrome Advanced” class – no flag required.

   Repo: https://github.com/readium/readium-css */

:root[style*="--USER__backgroundColor"] {
  background-color: var(--USER__backgroundColor) !important;
}

:root[style*="--USER__backgroundColor"] *,
:root[style*="background-color"] * {
  background-color: transparent !important;
}

:root[style*="--USER__textColor"] {
  color: var(--USER__textColor) !important;
}

:root[style*="--USER__textColor"] *:not(h1):not(h2):not(h3):not(h4):not(h5):not(h6):not(pre),
:root[style*="color"] *:not(h1):not(h2):not(h3):not(h4):not(h5):not(h6):not(pre) {
  color: inherit !important;
}

/* Readium CSS 
   Text align pref

   A submodule managing text-align for user settings
   Part of “User Overrides Advanced” class – “readium-advanced-on” flag required.

   Repo: https://github.com/readium/readium-css */

:root[style*="readium-advanced-on"][style*="--USER__textAlign"] {
  text-align: var(--USER__textAlign);
}

:root[style*="readium-advanced-on"][style*="--USER__textAlign"] body, :root[style*="text-align"] body,
:root[style*="readium-advanced-on"][style*="--USER__textAlign"] *:not(blockquote):not(figcaption) p, :root[style*="text-align"] *:not(blockquote):not(figcaption) p, 
:root[style*="readium-advanced-on"][style*="--USER__textAlign"] li, :root[style*="text-align"] li {
  text-align: inherit !important;
  -moz-text-align-last: auto !important;
  -epub-text-align-last: auto !important;
  text-align-last: auto !important;
}

/* In case something goes wrong at the programmatic level + rtl for body + rtl in ltr */

:root[style*="readium-advanced-on"][dir="rtl"][style*="--USER__textAlign: left"], 
:root[style*="readium-advanced-on"][dir="rtl"][style*="--USER__textAlign:left"],
:root[style*="readium-advanced-on"][dir="rtl"][style*="text-align: left"],
:root[style*="readium-advanced-on"][dir="rtl"][style*="text-align:left"],
:root[style*="readium-advanced-on"][style*="--USER__textAlign: left"] *[dir="rtl"], 
:root[style*="readium-advanced-on"][style*="--USER__textAlign:left"] *[dir="rtl"],
:root[style*="readium-advanced-on"][style*="text-align: left"] *[dir="rtl"],
:root[style*="readium-advanced-on"][style*="text-align:left"] *[dir="rtl"] {
  text-align: right;
}

/* IE 11, if logical value is used, think of it as a polyfill. For LTR, it will fall back to the default, which is left */

:root[style*="readium-advanced-on"][dir="rtl"][style*="--USER__textAlign: start"], 
:root[style*="readium-advanced-on"][dir="rtl"][style*="--USER__textAlign:start"],
:root[style*="readium-advanced-on"][dir="rtl"][style*="text-align: start"],
:root[style*="readium-advanced-on"][dir="rtl"][style*="text-align:start"] {
  text-align: right;
}

/* Readium CSS 
   Font Family pref

   A submodule managing font-family for user settings
   Part of “User Overrides” class – “readium-font-on” flag required.

   Repo: https://github.com/readium/readium-css */

/* [style*="--USER__fontOverride"] can be used to increase specificity but performance hit */

:root[style*="readium-font-on"][style*="--USER__fontFamily"] {
  font-family: var(--USER__fontFamily) !important;
}

:root[style*="readium-font-on"][style*="--USER__fontFamily"] body, :root[style*="font-family"] body,
:root[style*="readium-font-on"][style*="--USER__fontFamily"] p, :root[style*="font-family"] p,
:root[style*="readium-font-on"][style*="--USER__fontFamily"] li, :root[style*="font-family"] li,
:root[style*="readium-font-on"][style*="--USER__fontFamily"] div, :root[style*="font-family"] div,
:root[style*="readium-font-on"][style*="--USER__fontFamily"] dt, :root[style*="font-family"] dt,
:root[style*="readium-font-on"][style*="--USER__fontFamily"] dd, :root[style*="font-family"] dd {
  font-family: inherit !important;
}

:root[style*="readium-font-on"][style*="--USER__fontFamily"] i:not([lang]), :root[style*="font-family"] i:not([lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] i:not([xml\:lang]), :root[style*="font-family"] i:not([xml\:lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] em:not([lang]), :root[style*="font-family"] em:not([lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] em:not([xml\:lang]), :root[style*="font-family"] em:not([xml\:lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] cite:not([lang]), :root[style*="font-family"] cite:not([lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] cite:not([xml\:lang]), :root[style*="font-family"] cite:not([xml\:lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] b:not([lang]), :root[style*="font-family"] b:not([lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] b:not([xml\:lang]), :root[style*="font-family"] b:not([xml\:lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] strong:not([lang]), :root[style*="font-family"] strong:not([lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] strong:not([xml\:lang]), :root[style*="font-family"] strong:not([xml\:lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] span:not([lang]), :root[style*="font-family"] span:not([lang]),
:root[style*="readium-font-on"][style*="--USER__fontFamily"] span:not([xml\:lang]), :root[style*="font-family"] span:not([xml\:lang]) {
  font-family: inherit !important;
}

/* Readium CSS 
   Font size pref

   A submodule managing font-size for user settings
   Part of “User Overrides” class – no flag required.

   Repo: https://github.com/readium/readium-css */

:root[style*="--USER__fontSize"] {
  font-size: var(--USER__fontSize) !important;
}

/* Readium CSS 
   Line height pref

   A submodule managing line-height for user settings
   Part of “User Overrides Advanced” class – “readium-advanced-on” flag required.

   Repo: https://github.com/readium/readium-css */

:root[style*="readium-advanced-on"][style*="--USER__lineHeight"] {
  line-height: var(--USER__lineHeight) !important;
}

:root[style*="readium-advanced-on"][style*="--USER__lineHeight"] body, :root[style*="line-height"] body,
:root[style*="readium-advanced-on"][style*="--USER__lineHeight"] p, :root[style*="line-height"] p,
:root[style*="readium-advanced-on"][style*="--USER__lineHeight"] li, :root[style*="line-height"] li,
:root[style*="readium-advanced-on"][style*="--USER__lineHeight"] div, :root[style*="line-height"] div {
  line-height: inherit;
}

/* Readium CSS 
   Para spacing pref

   A submodule managing paragraphs’ top and bottom margins for user settings
   Part of “User Overrides Advanced” class – “readium-advanced-on” flag required.

   Repo: https://github.com/readium/readium-css */

:root[style*="readium-advanced-on"][style*="--USER__paraSpacing"] p {
  margin-top: var(--USER__paraSpacing) !important;
  margin-bottom: var(--USER__paraSpacing) !important;
}

/* Readium CSS 
   Para indent pref

   A submodule managing paragraphs’ text-indent for user settings
   Part of “User Overrides Advanced” class – “readium-advanced-on” flag required.

   Repo: https://github.com/readium/readium-css */

:root[style*="readium-advanced-on"][style*="--USER__paraIndent"] p {
  text-indent: var(--USER__paraIndent) !important;
}

/* If there are inline-block elements in paragraphs, text-indent will inherit so we must reset it */

:root[style*="readium-advanced-on"][style*="--USER__paraIndent"] p *,
:root[style*="readium-advanced-on"][style*="--USER__paraIndent"] p:first-letter {
  text-indent: 0 !important;
}

/* Readium CSS 
   Ligatures pref

   A submodule managing ligatures for user settings in the Arabic Script (can help with a11y)
   Part of “User Overrides Advanced” class – “readium-advanced-on” flag required.

   Repo: https://github.com/readium/readium-css */

:root[style*="readium-advanced-on"][style*="--USER__arabicLigatures"] {
  font-variant-ligatures: var(--USER__ligatures) !important;
}

:root[style*="readium-advanced-on"][style*="--USER__arabicLigatures"] * {
  font-variant-ligatures: inherit !important;
}