<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="generator" content="pandoc"/>
  <title>Readium CSS Implementers’ doc</title>
  <link rel="stylesheet" type="text/css" href="../Styles/stylesheet.css"/>
</head>

<body xml:lang="en">
  <section id="postcss" class="level1">
    <h1>PostCSS</h1>

    <p>[Implementers’ doc]</p>

    <p>PostCSS is a tool for transforming CSS with JavaScript. It comes with a vast amount of task-oriented plugins and allows authors to use modern specs which are not implemented yet.</p>

    <ul>
      <li><a href="http://postcss.org">PostCSS official website</a></li>

      <li><a href="https://webdesign.tutsplus.com/tutorials/using-postcss-for-cross-browser-compatibility--cms-24567">PostCSS tutorial</a></li>

      <li><a href="https://www.postcss.parts">PostCSS plugins list</a></li>
    </ul>

    <section id="dev-dependencies" class="level2">
      <h2 id="sigil_toc_id_136">Dev Dependencies</h2>

      <p>ReadiumCSS is relying on a PostCSS config to build <code>dist</code> stylesheets. If you <code>npm install</code> the repository, all those dependencies will be installed as well.</p>

      <p>Here is the current list of dependencies:</p>

      <ul>
        <li>stylelint (<a href="https://stylelint.io/user-guide/postcss-plugin/">link</a>);</li>

        <li>postcss-cli (<a href="https://github.com/postcss/postcss-cli">link</a>);</li>

        <li>postcss-import (<a href="https://github.com/postcss/postcss-import">link</a>);</li>

        <li>postcss-sorting (<a href="https://github.com/hudochenkov/postcss-sorting">link</a>);</li>

        <li>postcss-custom-media (<a href="https://github.com/postcss/postcss-custom-media">link</a>);</li>

        <li>postcss-custom-selectors (<a href="https://github.com/postcss/postcss-custom-selectors">link</a>);</li>

        <li>postcss-css-variables (<a href="https://github.com/MadLittleMods/postcss-css-variables">link</a>) [disabled];</li>

        <li>postcss-discard-comments (<a href="https://github.com/ben-eb/postcss-discard-comments">link</a>).</li>
      </ul>
    </section>

    <section id="build-dist-stylesheets" class="level2">
      <h2 id="sigil_toc_id_137">Build dist stylesheets</h2>

      <p>If you customize <code>ReadiumCSS-config.css</code>, you will have to rebuild stylesheets.</p>

      <p><strong>Note:</strong> the current build process is subpar – to say the least. Please feel free to improve it (gulp, grunt, etc.).</p>

      <section id="available-scripts" class="level3">
        <h3 class="sigil_not_in_toc">Available scripts</h3>

        <p>By default, the following scripts are available:</p>

        <ul>
          <li><code>build</code>, will build all stylesheets;</li>

          <li><code>build:ltr</code>, will build default stylesheets (Left to Right scripts);</li>

          <li><code>build:rtl</code>, will build stylesheets for Right to Left scripts;</li>

          <li><code>build:cjk</code>, will build stylesheets for Chinese, Japanese, and Korean in horizontal writing mode;</li>

          <li><code>build:vertical</code>, will build stylesheets for Chinese, Japanese, Korean, and Mongolian in vertical writing mode.</li>
        </ul>
      </section>

      <section id="usage" class="level3">
        <h3 class="sigil_not_in_toc">Usage</h3>

        <p>First navigate to the <code>readium-css</code> folder, then…</p>

        <pre><code>npm run-script build</code></pre>
      </section>

      <section id="building-dist-stylesheets-for-browsers-which-dont-support-css-variables" class="level3">
        <h3 class="sigil_not_in_toc">Building dist stylesheets for browsers which don’t support CSS variables</h3>

        <p>If you need to build stylesheets for IE11 or an early version of Edge (e.g. 14), then you can use most of ReadiumCSS, excepted user settings. You’ll consequently have to customize the <code>src</code>’s <code>ReadiumCSS-before.css</code>, <code>ReadiumCSS-default.css</code> and <code>ReadiumCSS-after.css</code> and remove the user settings submodules.</p>

        <p>Then you will have to enable the <code>postcss-css-variables</code> and <code>postcss-alter-property-value</code> in the <code>postcss.config.js</code> file to be found at the <code>src</code> folder’s root.</p>

        <p>The following must be added to <code>plugins</code>:</p>

        <pre><code>require("postcss-css-variables")({ 
  "preserve": true 
}), 
require("postcss-alter-property-value")({ 
  declarations: { 
    "*": { 
      task: "remove" 
    , whenValueEquals: "undefined" 
    } 
  } 
})</code></pre>

        <p>This will:</p>

        <ol>
          <li>interpolate CSS variables into a static representation, while preserving variables for other browsers (<code>"preserve": true</code>);</li>

          <li>remove static representations which can’t be interpolated and are <code>undefined</code> (<code>remove</code> task).</li>
        </ol>
      </section>
    </section>

    <section id="useful-plugins" class="level2">
      <h2 id="sigil_toc_id_138">Useful plugins</h2>

      <p>Here is a list of additionnal PostCSS plugins which might prove useful to implementers.</p>

      <ul>
        <li>Unprefix EPUB properties: <a href="https://github.com/JayPanoz/postcss-epub-interceptor">EPUB interceptor</a></li>

        <li>Adding vendor prefixes: <a href="https://github.com/postcss/autoprefixer">Autoprefixer</a></li>
      </ul>
    </section>
  </section>
</body>
</html>